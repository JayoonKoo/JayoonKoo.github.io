<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"jayoonkoo.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="website">
<meta property="og:title" content="풍경보면서 일하고 싶다.">
<meta property="og:url" content="https://jayoonkoo.github.io/page/2/index.html">
<meta property="og:site_name" content="풍경보면서 일하고 싶다.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="JayoonKoo">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jayoonkoo.github.io/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>풍경보면서 일하고 싶다.</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">풍경보면서 일하고 싶다.</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">디지털 노마드를 꿈꾸는 초보 개발자의 기술 블로그</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">10</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">8</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">102</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">JayoonKoo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">102</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/JayoonKoo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;JayoonKoo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:rnwkdbs12@gmail.com" title="E-Mail → mailto:rnwkdbs12@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/JayoonKoo" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/TEST_CODE/211020-test%20%EC%A0%84%ED%9B%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/TEST_CODE/211020-test%20%EC%A0%84%ED%9B%84/" class="post-title-link" itemprop="url">test 전후</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-10-23 22:14:44" itemprop="dateCreated datePublished" datetime="2021-10-23T22:14:44+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/test/" itemprop="url" rel="index"><span itemprop="name">test</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="test-전후"><a href="#test-전후" class="headerlink" title="test 전후"></a>test 전후</h1><h2 id="beforEach-afterEach"><a href="#beforEach-afterEach" class="headerlink" title="beforEach, afterEach"></a>beforEach, afterEach</h2><p>각 테스트 전에 먼저 실행되어야 할 코드 가 있을 수 있다. 예를 들어서 어떤 테스트가 다음 번에 테스트에 영향을 끼치는 변수를 변경하고 있다면 변수를 초기화 해주는 코드가 필요하다.</p>
<p>해당 작업은 <code>beforeEach</code>를 통해서 할 수 있다.</p>
<p>예시 코드는 각 test 전에 num 값을 0으로 초기화 해서 다음 test에 주는 영향을 없앤다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">beforeEach(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  num = <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;0 더하기 1은 1이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  num = fn.add(num, <span class="number">1</span>);</span><br><span class="line">  expect(num).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 2은 2이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  num = fn.add(num, <span class="number">2</span>);</span><br><span class="line">  expect(num).toBe(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 3은 3이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  num = fn.add(num, <span class="number">3</span>);</span><br><span class="line">  expect(num).toBe(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 4은 4이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  num = fn.add(num, <span class="number">4</span>);</span><br><span class="line">  expect(num).toBe(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 5은 5이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  num = fn.add(num, <span class="number">5</span>);</span><br><span class="line">  expect(num).toBe(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>afterEach</code> 는 각 테스트 이후에 실행될 함수이다.</p>
<h2 id="beforeAll-afterAll"><a href="#beforeAll-afterAll" class="headerlink" title="beforeAll, afterAll"></a>beforeAll, afterAll</h2><p>어떤 테스트는 처음 테스트가 시행되기전에 한번 사전 작업을 하고, 모든 테스트가 끝나고 난 뒤에 수행해야 할 작업이 있을 수 있다. 예를들어 db에 커넥션을 얻고 해제하는 경우가 그렇다.</p>
<p>만약 <code>beforeEach</code>나 <code>afterEach</code> 같은 것을 사용하면 각 테스트마다 커넥션을 얻고 해제하는것을 반복하기 때문에 시간이 테스트 수 곱하기로 들것이다. 이러때는 <code>All</code>을 사용해서 한번씩만 호출되도록 할 수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">beforeAll(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  user = <span class="keyword">await</span> fn.connectUserDb();</span><br><span class="line">&#125;);</span><br><span class="line">afterAll(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  user = <span class="keyword">await</span> fn.disconnectUserDb();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;이름은 KOO 야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(user.name).toBe(<span class="string">&quot;KOO&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;나이는 27 야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(user.age).toBe(<span class="number">27</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;성별은 남자야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(user.gender).toBe(<span class="string">&quot;male&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="describe"><a href="#describe" class="headerlink" title="describe"></a>describe</h2><p>테스트를 묶어서 설명할 수 있다. 테스트는 한 스코프 안에서 실행되는데 여기에 선언한 <code>before</code>, <code>after</code> 관련 함수는 해당 스코프를 범위로 실행된다.</p>
<p>car 스코프 안에서 커넥션을 얻고 해제하는 과정이 한번 일어난다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> user;</span><br><span class="line">beforeAll(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  user = <span class="keyword">await</span> fn.connectUserDb();</span><br><span class="line">&#125;);</span><br><span class="line">afterAll(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> fn.disconnectUserDb();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;이름은 KOO 야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(user.name).toBe(<span class="string">&quot;KOO&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;나이는 27 야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(user.age).toBe(<span class="number">27</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;성별은 남자야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(user.gender).toBe(<span class="string">&quot;male&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;Car 관련 작업&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> car;</span><br><span class="line">  beforeAll(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    car = <span class="keyword">await</span> fn.connectCarrDb();</span><br><span class="line">  &#125;);</span><br><span class="line">  afterAll(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> fn.disconnectUserDb();</span><br><span class="line">  &#125;);</span><br><span class="line">  test(<span class="string">&quot;이름은 sonata 야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    expect(car.name).toBe(<span class="string">&quot;sonata&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  test(<span class="string">&quot;브랜드는 kia야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    expect(car.brand).toBe(<span class="string">&quot;kia&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="순서"><a href="#순서" class="headerlink" title="순서?"></a>순서?</h2><p>describe 바깥과 안에 각각 <code>beforeAll</code>, <code>beforeEach</code>, <code>afterEach</code>, <code>afterAll</code> 이 모두 정의 되어 있다면 어떤 순서로 진행 될까 ?</p>
<p>다음과 같은 경우이다 :</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">beforeAll(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">beforeEach(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">afterEach(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">afterAll(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">test(<span class="string">&quot;&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">&quot;&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  beforeAll(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">  beforeEach(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">  afterEach(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">  afterAll(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">  test(<span class="string">&quot;&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>순서는 다음과 같다 :</p>
<ol>
<li> 밖 beforeAll</li>
<li> 밖 beforeEach</li>
<li> 밖 test</li>
<li> 밖 afterEach</li>
<li><pre><code>   안 beforeAll
</code></pre>
</li>
<li> 밖 beforeEach</li>
<li><pre><code>   안 beforeEach
</code></pre>
</li>
<li> 안 test</li>
<li> 안 afterEach</li>
<li>밖 afterEach</li>
<li><pre><code>안 afterAll
</code></pre>
</li>
<li>밖 afterAll</li>
</ol>
<p>test 시 순서에 유의하도록 한다.</p>
<h2 id="skip-only"><a href="#skip-only" class="headerlink" title="skip only"></a>skip only</h2><p>skip 은 지정한 test를 스킵할때, only 는 지정한 test만 실행할때 사용할 수 있다.</p>
<p>test 가 실패햇다면 다음과 같은 순서로 작업을 진행할 수 있다.</p>
<ol>
<li>어떤 test1 실패</li>
<li>test1 만 only로 실행</li>
<li>test1 수정 -&gt; 통과 확인</li>
<li>영향 주는 test0 찾음</li>
<li>test0을 수정하는것이 best지만 일단 test를 해야 한다면 test0을 skip 하고 실행</li>
</ol>
<p>순서대로 하면 다음과 같다.<br>1 : 마지막 테스트 실패</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;0 더하기 1은 1이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">1</span>)).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 2은 2이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">2</span>)).toBe(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 3은 3이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">3</span>)).toBe(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 4은 4이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">4</span>)).toBe(<span class="number">4</span>);</span><br><span class="line">  num = <span class="number">10</span>;</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 5은 5이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">5</span>)).toBe(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>2 : 마지막 test만 only 로 실행</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;0 더하기 1은 1이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">1</span>)).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 2은 2이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">2</span>)).toBe(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 3은 3이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">3</span>)).toBe(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 4은 4이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">4</span>)).toBe(<span class="number">4</span>);</span><br><span class="line">  num = <span class="number">10</span>;</span><br><span class="line">&#125;);</span><br><span class="line">test.only(<span class="string">&quot;0 더하기 5은 5이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">5</span>)).toBe(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>3,4 : 수정후 영향을 주는 test 확인</p>
<p>5 : 문제되는 test skip 하고 진행</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">&quot;0 더하기 1은 1이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">1</span>)).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 2은 2이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">2</span>)).toBe(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 3은 3이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">3</span>)).toBe(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test.skip(<span class="string">&quot;0 더하기 4은 4이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">4</span>)).toBe(<span class="number">4</span>);</span><br><span class="line">  num = <span class="number">10</span>;</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;0 더하기 5은 5이야&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(fn.add(num, <span class="number">5</span>)).toBe(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/TEST_CODE/211022-mock%ED%95%A8%EC%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/TEST_CODE/211022-mock%ED%95%A8%EC%88%98/" class="post-title-link" itemprop="url">mock함수</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-10-23 22:14:44" itemprop="dateCreated datePublished" datetime="2021-10-23T22:14:44+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/test/" itemprop="url" rel="index"><span itemprop="name">test</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="mock"><a href="#mock" class="headerlink" title="mock"></a>mock</h1><p>test를 진행하기 위해서 많은 코들르 작성해야 할때 임시로 mock 함수를 사용해서 기능이 정상 작동하는지 확인할 수 있다.</p>
<h2 id="calls"><a href="#calls" class="headerlink" title="calls"></a>calls</h2><p>mock 안에 mock.calls 가 있어서 몇번 실행됬는지 인수는 무엇이였는지 확인 가능</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mock = jest.fn();</span><br><span class="line"></span><br><span class="line">mock();</span><br><span class="line">mock(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;mock 함수는 2번 호출되었다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock.mock.calls.length).toBe(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;2번째 호출의 인수는 1이다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock.mock.calls[<span class="number">1</span>][<span class="number">0</span>]).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>인수도 확인 가능하다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mock = jest.fn();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEachOne</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  arr.forEach(<span class="function">(<span class="params">num</span>) =&gt;</span> &#123;</span><br><span class="line">    mock(num + <span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">addEachOne([<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;mock 함수는 3번 불렸다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock.mock.calls.length).toBe(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;가 값은 11, 21, 31이다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock.mock.calls[<span class="number">0</span>][<span class="number">0</span>]).toBe(<span class="number">11</span>);</span><br><span class="line">  expect(mock.mock.calls[<span class="number">1</span>][<span class="number">0</span>]).toBe(<span class="number">21</span>);</span><br><span class="line">  expect(mock.mock.calls[<span class="number">2</span>][<span class="number">0</span>]).toBe(<span class="number">31</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="return"><a href="#return" class="headerlink" title="return"></a>return</h2><p>fn()에 콜백함수를 전달해서 result로 확인할 수 있다.</p>
<p>results 배열로 들어오고 value로 return 값 확인이 가능하다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mock = jest.fn(<span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">mock(<span class="number">10</span>);</span><br><span class="line">mock(<span class="number">20</span>);</span><br><span class="line">mock(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;10에서 1증가한 11이 반환된다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock.mock.results[<span class="number">0</span>].value).toBe(<span class="number">11</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;20에서 1증가한 21이 반환된다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock.mock.results[<span class="number">1</span>].value).toBe(<span class="number">21</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;30에서 1증가한 31이 반환된다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock.mock.results[<span class="number">2</span>].value).toBe(<span class="number">31</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>mockReturnValueOnce를 통해서 한번만 리턴하는 값을 정할 수 있다.</p>
<p>체이닝으로 연결하고 마지막은 mockReturnValue로 정한다.</p>
<p>홀수 판별을 위한 콜백을 당장 작성할수 없다 판단될때 다음과 같이 작성할 수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mock = jest.fn(<span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">mock</span><br><span class="line">  .mockReturnValueOnce(<span class="literal">true</span>)</span><br><span class="line">  .mockReturnValueOnce(<span class="literal">false</span>)</span><br><span class="line">  .mockReturnValueOnce(<span class="literal">true</span>)</span><br><span class="line">  .mockReturnValueOnce(<span class="literal">false</span>)</span><br><span class="line">  .mockReturnValue(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;홀수는 135 이다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].filter(<span class="function">(<span class="params">num</span>) =&gt;</span> mock(num));</span><br><span class="line">  expect(result).toStrictEqual([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>mockResolvedValue 를 통해서 비동기 함수를 흉내 낼 수 도 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mock = jest.fn(<span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">mock.mockResolvedValue(&#123; <span class="attr">name</span>: <span class="string">&quot;mike&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;이름은 mike이다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  mock().then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    expect(res.name).toBe(<span class="string">&quot;mike&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="기존-함수를-mock-함수로-만들기"><a href="#기존-함수를-mock-함수로-만들기" class="headerlink" title="기존 함수를 mock 함수로 만들기"></a>기존 함수를 mock 함수로 만들기</h2><p>유저 생성 함수를 test 한다고 생각할 때 실제로 user가 생성해 버리면 롤백하기도 번거로울 것이다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">createUser: <span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">&quot;실제로 유저가 생성되었다.&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">user</span>: name</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br></pre></td></tr></table></figure>

<p>fn을 목킹 모드로 만든다. 이러면 실제 fn에 함수가 호출되는 것이 아니라 목함수가 동작한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line">jest.mock(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line">fn.createUser.mockReturnValue(&#123; <span class="attr">user</span>: <span class="string">&quot;Mike&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;유저가 생성되었습니다.&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result = fn.createUser(<span class="string">&quot;Mike&quot;</span>);</span><br><span class="line">  expect(result.user).toBe(<span class="string">&quot;Mike&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="그-외에-유용한-메서드"><a href="#그-외에-유용한-메서드" class="headerlink" title="그 외에 유용한 메서드"></a>그 외에 유용한 메서드</h2><p>mock 함수 호출에 대한 유용한 메서드를 제공한다.</p>
<ul>
<li>toBeCalled() 한번이라도 호출됬으면 통과</li>
<li>toBeCalledTimes(3) 3번 통과 됬으면 통과</li>
<li>toBeCalledWith(10, 20) 인수로 주어진 것을 받은게 있다면 통과</li>
<li>lastCalledWith(10, 20) 마지막으로 받은 인수가 10, 20이면 통과</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fn = <span class="built_in">require</span>(<span class="string">&quot;./fn&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mock = jest.fn();</span><br><span class="line"></span><br><span class="line">mock(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">mock();</span><br><span class="line">mock(<span class="number">30</span>, <span class="number">40</span>);</span><br><span class="line"></span><br><span class="line">test(<span class="string">&quot;호출됨&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock).toBeCalled();</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;3 번 호출됨&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock).toBeCalledTimes(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;10, 20 인수로 받음&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock).toBeCalledWith(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">&#125;);</span><br><span class="line">test(<span class="string">&quot;호출됨&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  expect(mock).lastCalledWith(<span class="number">30</span>, <span class="number">40</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/DevOps/Docker/211018-Docker%20basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/DevOps/Docker/211018-Docker%20basic/" class="post-title-link" itemprop="url">Docker basic</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:11:53 / Modified: 22:12:41" itemprop="dateCreated datePublished" datetime="2021-10-23T22:11:53+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps/" itemprop="url" rel="index"><span itemprop="name">DevOps</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><p>가상 os를 사용해본 경험이 한번쯤은 있을 것이다. 가상 os는 vm 같은 프로그램을 사용해서 현제 os 위에 새로운 os를 설치하는 것인데 이를 통해서 다른 host os 와는 다른 os를 사용할 수 있게 된다.</p>
<p>vm ware와 같은 소프트웨어에서는 hostos 위에 hypervisor 를 두어서 그 위에 가상 os를 설치하는 방법을 사용한다. 이때 하드웨어 리소스를 필요한 부분 만큼 떼어 놓고 그 리소스 안에서 os를 사용하게 되는데 성능상에 손실이 있을 수 있다.</p>
<p>그에 반에 Docker는 Docker engine 을 사용하여 프로세스 수준으로 리소스를 격리할 수 있다.</p>
<h2 id="Docker를-사용하는-이유"><a href="#Docker를-사용하는-이유" class="headerlink" title="Docker를 사용하는 이유?"></a>Docker를 사용하는 이유?</h2><ol>
<li>컨테이너 이미지의 용량이 적다.</li>
<li>배포 속도가 빠르다.</li>
<li>가상화된 공간을 사용할 때의 성능손실이 적다.</li>
</ol>
<h2 id="Docker-설치"><a href="#Docker-설치" class="headerlink" title="Docker 설치"></a>Docker 설치</h2><p><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/ubuntu/">설치 docs</a> 우분투에 대한 내용은 여기서 찾아 볼 수 있다. 문서를 보고 다른 os도 따라서 해보면 된다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/DB/SQLD/211008-5.SQL%20%EA%B8%B0%EB%B3%B8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/DB/SQLD/211008-5.SQL%20%EA%B8%B0%EB%B3%B8/" class="post-title-link" itemprop="url">5.SQL 기본</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:07:35 / Modified: 22:09:58" itemprop="dateCreated datePublished" datetime="2021-10-23T22:07:35+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="5-SQL-기본"><a href="#5-SQL-기본" class="headerlink" title="5.SQL 기본"></a>5.SQL 기본</h1><h2 id="SELECT-문"><a href="#SELECT-문" class="headerlink" title="SELECT 문"></a>SELECT 문</h2><p>데이터 조회 조회할 테이블과 항목을 명시해 준다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		CUSTOMER_ID ,</span><br><span class="line">		NAME ,</span><br><span class="line">		CREDIT_LIMIT</span><br><span class="line"><span class="keyword">FROM</span> CUSTOMERS ;</span><br></pre></td></tr></table></figure>

<p>모든 항목 조회는</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		<span class="operator">*</span></span><br><span class="line">	<span class="keyword">FROM</span> CUSTOMERS</span><br></pre></td></tr></table></figure>

<h3 id="DUAL-테이블"><a href="#DUAL-테이블" class="headerlink" title="DUAL 테이블"></a>DUAL 테이블</h3><p>DB에서 기본적으로 제공해주는 테이블로서 연산 작업에 사용할 수 있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		<span class="operator">*</span></span><br><span class="line">	<span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		(<span class="number">10</span> <span class="operator">+</span> <span class="number">5</span>) <span class="operator">/</span> <span class="number">2</span> <span class="keyword">AS</span> VAL</span><br><span class="line">	<span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h3 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a>ORDER BY</h3><p>크기를 기준으로 정렬해준다.</p>
<ul>
<li>ASC: 오름차순 (디폴트)</li>
<li>DESC: 내림차순</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		NAME,</span><br><span class="line">		ADDRESS,</span><br><span class="line">		CREDIT_LIMIT,</span><br><span class="line">	<span class="keyword">FROM</span> CUSTOMERS</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> NAME <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<p>ORDER BY 다음으로는 여러개의 항목을 줄 수 있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		FIRST_NAME,</span><br><span class="line">		LAST_NAME,</span><br><span class="line">	<span class="keyword">FROM</span> CONTACTS</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> FIRST_NAME, LAST_NAME <span class="keyword">DESC</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<p>FIRST_NAME은 디폴트 값인 오름차순으로 정렬하고 그다음에 LAST_NAME을 기준으로 내림차순 정렬한다.</p>
<h3 id="DISTINCT"><a href="#DISTINCT" class="headerlink" title="DISTINCT"></a>DISTINCT</h3><p>중복 값을 제거한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		<span class="keyword">DISTINCT</span> FIRST_NAME</span><br><span class="line">	<span class="keyword">FROM</span> CONTACTS</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> FIRST_NAME</span><br></pre></td></tr></table></figure>

<p>조회 결과 중에서 FIRST_NAME 이 겹친다면 중복된 요소를 제거한다.</p>
<h3 id="WHERE"><a href="#WHERE" class="headerlink" title="WHERE"></a>WHERE</h3><p>조건을 주어서 검생할 수 있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		PRODUCT_NAME,</span><br><span class="line">		DESCRIPTION,</span><br><span class="line">		LIST_PRICE,</span><br><span class="line">		CATEGORY_ID</span><br><span class="line">	<span class="keyword">FROM</span> PRODUCTS</span><br><span class="line">	<span class="keyword">WHERE</span> PRODUCT_NAME<span class="operator">=</span><span class="string">&#x27;Kinston&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>일반적인 프로그래밍 언어와 마찬가지로 AND 와 OR을 사용할 수 있고 조건 사이에 넣어 주면 된다.</p>
<p>BETWEEN을 입력하여 이상 이하에 조건을 간략하게 표현할 수 있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">		PRODUCT_NAME,</span><br><span class="line">		LIST_PRICE</span><br><span class="line">	<span class="keyword">FROM</span> PRODUCTS</span><br><span class="line">	<span class="keyword">WHERE</span> LIST_PRICE <span class="keyword">BETWEEN</span> <span class="number">650</span> <span class="keyword">AND</span> <span class="number">680</span></span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> LIST_PRICE;</span><br></pre></td></tr></table></figure>

<p>LIST_PRICE 가 650 이상 680 미만인 것을 조회한다.</p>
<p>IN 조건을 주면 집합에 속한 모든 요소를 출력할 수 있다. OR 조건과 비슷하다고 생각하면 된다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">       PRODUCT_NAME</span><br><span class="line">     , CATEGORY_ID</span><br><span class="line"><span class="keyword">FROM</span> PRODUCTS</span><br><span class="line"><span class="keyword">WHERE</span> CATEGORY_ID <span class="keyword">IN</span> (<span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> PRODUCT_NAME ;</span><br></pre></td></tr></table></figure>

<p>LIKE 를 사용해서 조건을 넣을 수 있다. 밑에는 ASUS로 시작하는 요소를 검색한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">       PRODUCT_NAME</span><br><span class="line">     , LIST_PRICE</span><br><span class="line"><span class="keyword">FROM</span> PRODUCTS</span><br><span class="line"><span class="keyword">WHERE</span> PRODUCT_NAME <span class="keyword">LIKE</span> <span class="string">&#x27;Asus%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> LIST_PRICE ;</span><br></pre></td></tr></table></figure>

<h2 id="INSERT-UPDATE-DELETE-문"><a href="#INSERT-UPDATE-DELETE-문" class="headerlink" title="INSERT, UPDATE, DELETE 문"></a>INSERT, UPDATE, DELETE 문</h2><p>테이블 생성</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> DISCOUNTS;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> DISCOUNTS (</span><br><span class="line">DISCOUNT_ID NUMBER GENERATED <span class="keyword">BY</span> <span class="keyword">DEFAULT</span> <span class="keyword">AS</span> <span class="keyword">IDENTITY</span> , DISCOUNT_NAME VARCHAR2(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">, AMOUNT NUMBER(<span class="number">3</span>, <span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">, START_DATE <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">, EXPIRED_DATE <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h3><p>데이터를 삽입한다. 데이터를 삽입을 확정하기 위해서 COMMIT을 해야 한다. 하지만 보통 DB tools 에서는 자동으로 COMMIT 까지 들어가도록 지원한다. 테이블 생성 명령어는 COMMIT 이 필요하지 않다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span></span><br><span class="line">DISCOUNTS (</span><br><span class="line">DISCOUNT_NAME , AMOUNT</span><br><span class="line">, START_DATE</span><br><span class="line">, EXPIRED_DATE )</span><br><span class="line"><span class="keyword">VALUES</span> ( <span class="string">&#x27;Summer Promotion&#x27;</span> , <span class="number">9.5</span></span><br><span class="line">, <span class="type">DATE</span> <span class="string">&#x27;2017-05-01&#x27;</span> , <span class="type">DATE</span> <span class="string">&#x27;2017-08-31&#x27;</span> );</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<h3 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h3><p>테이블 안에 데이터를 업데이트 한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE PARTS</span><br><span class="line"><span class="keyword">SET</span> COST <span class="operator">=</span> <span class="number">130</span></span><br><span class="line"><span class="keyword">WHERE</span> PART_ID <span class="operator">=</span> <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>조건을 입력하지 않으면 테이블에 모든 행을 업데이트 한다. 조건문이 없는 UPDATE, DELETE 문은 DB tools 에서 경고문을 던진다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE PARTS</span><br><span class="line">   <span class="keyword">SET</span> COST <span class="operator">=</span> COST <span class="operator">*</span> <span class="number">1.05</span></span><br><span class="line">;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><p>데이터를 삭제한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line">  <span class="keyword">FROM</span> SALES</span><br><span class="line"> <span class="keyword">WHERE</span> ORDER_ID <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">AND</span> ITEM_ID <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<h2 id="VIEW"><a href="#VIEW" class="headerlink" title="VIEW"></a>VIEW</h2><p>VIEW 는 물리적으로 데이터를 저장하지 않는 테이블이라고 생각할 수 있는데 쉽게 생각하면 어떤 SQL에 결과값을 저장해 둔 것이라고 생각하면 된다.</p>
<h3 id="INLINE-VIEW"><a href="#INLINE-VIEW" class="headerlink" title="INLINE VIEW"></a>INLINE VIEW</h3><p>SQL 문 안에서 INLINE VIEW 를 사용할 수 있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.<span class="operator">*</span> <span class="keyword">FROM</span></span><br><span class="line">(</span><br><span class="line">	<span class="keyword">SELECT</span></span><br><span class="line">		NAME</span><br><span class="line">	, CREDIT_LIMIT</span><br><span class="line">	<span class="keyword">FROM</span> CUSTOMERS</span><br><span class="line"> )A</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h3 id="VIEW-1"><a href="#VIEW-1" class="headerlink" title="VIEW"></a>VIEW</h3><p>복잡한 쿼리에 대한 결과를 VIEW로 저장해두고 사용할 수 있다. 다음 쿼리는 발송된 주문에 대한 연도별 각 고객의 매출 총 금액을 구하는 SQL 문이다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">C.NAME <span class="keyword">AS</span> CUSTOMER</span><br><span class="line">, TO_CHAR(A.ORDER_DATE, <span class="string">&#x27;YYYY&#x27;</span>) <span class="keyword">AS</span> <span class="keyword">YEAR</span></span><br><span class="line">, <span class="built_in">SUM</span>( B.QUANTITY <span class="operator">*</span> B.UNIT_PRICE ) SALES_AMOUNT <span class="keyword">FROM</span> ORDERS A</span><br><span class="line">     , ORDER_ITEMS B</span><br><span class="line">, CUSTOMERS C</span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">AND</span> A.STATUS <span class="operator">=</span> <span class="string">&#x27;Shipped&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> A.ORDER_ID <span class="operator">=</span> B.ORDER_ID</span><br><span class="line"><span class="keyword">AND</span> A.CUSTOMER_ID <span class="operator">=</span> C.CUSTOMER_ID</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> C.NAME, TO_CHAR(A.ORDER_DATE, <span class="string">&#x27;YYYY&#x27;</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> C.NAME</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<p>CREATE OR REPLACE VIEW 로 VIEW를 생성할 수있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> CUSTOMER_SALES <span class="keyword">AS</span> <span class="keyword">SELECT</span></span><br><span class="line">C.NAME <span class="keyword">AS</span> CUSTOMER</span><br><span class="line">, TO_CHAR(A.ORDER_DATE, <span class="string">&#x27;YYYY&#x27;</span>) <span class="keyword">AS</span> <span class="keyword">YEAR</span></span><br><span class="line">, <span class="built_in">SUM</span>( B.QUANTITY <span class="operator">*</span> B.UNIT_PRICE ) SALES_AMOUNT</span><br><span class="line"><span class="keyword">FROM</span> ORDERS A</span><br><span class="line">, ORDER_ITEMS B , CUSTOMERS C</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line">   <span class="keyword">AND</span> A.STATUS <span class="operator">=</span> <span class="string">&#x27;Shipped&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> A.ORDER_ID <span class="operator">=</span> B.ORDER_ID</span><br><span class="line">   <span class="keyword">AND</span> A.CUSTOMER_ID <span class="operator">=</span> C.CUSTOMER_ID</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> C.NAME, TO_CHAR(A.ORDER_DATE, <span class="string">&#x27;YYYY&#x27;</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> C.NAME;</span><br></pre></td></tr></table></figure>

<p>다음 부터는 CUSTOMER_SALES 로 VIEW 테이블을 조회할 수 있다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">       CUSTOMER</span><br><span class="line">     , SALES_AMOUNT</span><br><span class="line"><span class="keyword">FROM</span> CUSTOMER_SALES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">YEAR</span> <span class="operator">=</span> <span class="number">2017</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> SALES_AMOUNT <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<h2 id="서브-쿼리"><a href="#서브-쿼리" class="headerlink" title="서브 쿼리"></a>서브 쿼리</h2><h3 id="서브쿼리-기본"><a href="#서브쿼리-기본" class="headerlink" title="서브쿼리 기본"></a>서브쿼리 기본</h3><p>select 절에 또다른 select절이 있어서 쿼리 안에 또다른 쿼리가 있으면 서브 쿼리라고 한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">PRODUCT_ID , PRODUCT_NAME , LIST_PRICE</span><br><span class="line">  <span class="keyword">FROM</span> PRODUCTS</span><br><span class="line"> <span class="keyword">WHERE</span> LIST_PRICE <span class="operator">=</span> (</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">                          <span class="built_in">MAX</span>(LIST_PRICE)</span><br><span class="line">                     <span class="keyword">FROM</span> PRODUCTS</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="스칼라-서브-쿼리"><a href="#스칼라-서브-쿼리" class="headerlink" title="스칼라 서브 쿼리"></a>스칼라 서브 쿼리</h3><p>select 중간에 쿼리가 있으면 스칼라 서브 쿼리라고 한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">A.PRODUCT_NAME</span><br><span class="line">, A.LIST_PRICE</span><br><span class="line">, ROUND( (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(K.LIST_PRICE)</span><br><span class="line">                 <span class="keyword">FROM</span> PRODUCTS K</span><br><span class="line">               <span class="keyword">WHERE</span> K.CATEGORY_ID <span class="operator">=</span> A.CATEGORY_ID</span><br><span class="line">            ), <span class="number">2</span></span><br><span class="line">       ) AVG_LIST_PRICE</span><br><span class="line">  <span class="keyword">FROM</span> PRODUCTS A</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> A.PRODUCT_NAME;</span><br></pre></td></tr></table></figure>

<h3 id="인라인-뷰-서브-쿼리"><a href="#인라인-뷰-서브-쿼리" class="headerlink" title="인라인 뷰 서브 쿼리"></a>인라인 뷰 서브 쿼리</h3><p>앞서서 뷰를 보았는데 인라인 뷰도 일종의 서브 쿼리이다. 그래서 이를 인라인 뷰 서브쿼리라고 한다.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ORDER_ID</span><br><span class="line">, ORDER_VALUE</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> ORDER_ID</span><br><span class="line">, <span class="built_in">SUM</span>( QUANTITY <span class="operator">*</span> UNIT_PRICE ) ORDER_VALUE</span><br><span class="line">  <span class="keyword">FROM</span> ORDER_ITEMS</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> ORDER_ID</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> ORDER_VALUE <span class="keyword">DESC</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">WHERE</span> ROWNUM <span class="operator">&lt;=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/DB/SQLD/211011-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/DB/SQLD/211011-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98/" class="post-title-link" itemprop="url">트랜잭션</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:07:35 / Modified: 22:09:58" itemprop="dateCreated datePublished" datetime="2021-10-23T22:07:35+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="트랜잭션"><a href="#트랜잭션" class="headerlink" title="트랜잭션"></a>트랜잭션</h1><h2 id="트랜잭션이란"><a href="#트랜잭션이란" class="headerlink" title="트랜잭션이란?"></a>트랜잭션이란?</h2><p>트랜잭션은 데이터베이스 시스템에서 상호작용 단위로서 어떤 기능에 한 단위라고 생가하면 된다. 예를 들어서 송금 서비스의 입근 요청부터 확인까지의 단위이나, 예매 시스템에서 좌석을 확인하고 예매까지 하는 한 뒨위라고 할 수 있다.</p>
<h3 id="트랜잭션의-4대-특징-ACID"><a href="#트랜잭션의-4대-특징-ACID" class="headerlink" title="트랜잭션의 4대 특징(ACID)"></a>트랜잭션의 4대 특징(ACID)</h3><ol>
<li>원자성(Atomicty) : 데이터 조작이 전부 성공 혹은 전부 실패할지 보증하는 구조</li>
<li>일관성(Consistency) : 데이터 조작 전후에 일관성 유지, 기존의 데이터베이스가 <code>Correct State</code> 라면 트렌잭션을 수행하고 난 후에도 <code>Correct State</code> 여야 한다. -&gt; 도메인 유효봄위, 무결성 제약조건 등의 제약조건을 위배하지 않는 정상적인 상태, 예를들어 시스템에 사용자 등록 시 등록본호에 유일성 제약을 설정하는것과, 잔액이 있어야 송금 할 수 잇다는 일관성을 지키는 것등이 있다.</li>
<li>고립성(Isolation) : 복수 사용자가 동시에 데이터 조작을 실행한 경우 각각의 처리가 모순 없이 실행되는 것을 보증, 트랜잭션 격리 수준</li>
<li>지속성(Durability) : 데이터 조작 완료 후 완료 통지 받는 시점에서 결과를 잃지 않는것, 즉 트랜잭션이 Commit 되고 나면 데이터 변경 사항이 영구적으로 확장되도록 보장하는 것</li>
</ol>
<h2 id="트랜잭션-처리의-필요성"><a href="#트랜잭션-처리의-필요성" class="headerlink" title="트랜잭션 처리의 필요성"></a>트랜잭션 처리의 필요성</h2><h3 id="원자성의-중요성"><a href="#원자성의-중요성" class="headerlink" title="원자성의 중요성"></a>원자성의 중요성</h3><p>트랜잭션은 전부 성공하거나 혹은 전부 실패 해야 한다. 부분 성공이 있으면 안된다. 예를 들어서 어떤 얘매 시스템에서 좌석을 선택하고 결제단계에서 취소했다면 부분적 성공인 좌석 선택까지를 그대로 성공으로 두는 것이 아니라 모두 실패로 좌석 선택까지 실패시키는 것이다. 이렇게 해야 다른 사람이 좌석을 선택할 수 잇다.</p>
<h3 id="고립성의-중요성"><a href="#고립성의-중요성" class="headerlink" title="고립성의 중요성"></a>고립성의 중요성</h3><p>복수의 사용자가 트랜잭션의 모순이 없어야 한다.<br><img src="/images/211011-트랜잭션/1.png" width="500"></p>
<h2 id="격리-수준"><a href="#격리-수준" class="headerlink" title="격리 수준"></a>격리 수준</h2><ul>
<li>Read Uncommitted : Commit 되지 않아도 읽기 기능, 동시성은 좋지만, 일관성은 매우 떨어짐.</li>
<li>Read Committed : Commit 된 내용만 읽기, 오라클 기본</li>
<li>Repeatable Read : 반복 읽기 중에, 내용이 업데이트 되는 것을 방지</li>
<li>Serializable : 직렬화 기능으로서 트랜 잭션 처리 중에 insert 도 금지</li>
</ul>
<p>밑으로 갈수록 격리 수준은 높아지지만 <code>Serializable</code> 수준까지 가면 DBMS 운영 시 동시성이 크게 덜어지면서 성능 이슈가 발생한다.</p>
<h3 id="격리-수준이에-따른-발생-현상"><a href="#격리-수준이에-따른-발생-현상" class="headerlink" title="격리 수준이에 따른 발생 현상"></a>격리 수준이에 따른 발생 현상</h3><ul>
<li>Dirty Read : 커밋되지 않은 결과도 읽어서 좋지 않은 상태</li>
<li>Non-Repeatable Read: 트랜잭션 중간에 어데이트를 허용해서 애매하게 읽은 상태</li>
<li>Phantom Read : 트랜잭션 중간에 insert를 허용해서 혼란스러운 상태, 유령 읽기</li>
</ul>
<h3 id="격리-수준과-3가지-현상의-관계"><a href="#격리-수준과-3가지-현상의-관계" class="headerlink" title="격리 수준과 3가지 현상의 관계"></a>격리 수준과 3가지 현상의 관계</h3><img src="/images/211011-트랜잭션/2.png" width="500">

<p><code>ALTER SESSION SET ISOLATION_LEVEL = SERIALIZABLE;</code> 다음 명령어로 격리 수준 설정 가능.</p>
<h2 id="락과-데드락"><a href="#락과-데드락" class="headerlink" title="락과 데드락"></a>락과 데드락</h2><p>어떤 세션에서 트랜잭션 중에 다른 세션에서 데이터를 수정하지 못하도록 잠그는 기능을 락이라고 한다.</p>
<h3 id="락의-유형"><a href="#락의-유형" class="headerlink" title="락의 유형"></a>락의 유형</h3><ul>
<li>공유락 (Shared Lock) : 데이터 읽기를 할때 공유락이 걸려 있으면 데이터를 볼수는 있지만 업데이트 할 수는 없다. (오라클은 공유락을 설정하지 않고 mvcc 라는 기술을 사용한다.)</li>
<li>배타락 (Exclusive Lock) : 배타락이 걸려 있으면 데이터를 볼수도 없다.</li>
</ul>
<h3 id="데드락"><a href="#데드락" class="headerlink" title="데드락"></a>데드락</h3><p>데드락은 두 개 이상의 트랜잭션이 각각 자신의 데이터에 대하여 락을 흭득하고 상대방 데이터에 대하여 락을 요청 요청하면 무한대기 상태에 빠질 수 있는 현상이다.</p>
<p>예를들어,</p>
<ol>
<li>사용자1 이 테이블 A에 대해서 쓰기 작업을 진행하면서 락을 걸고</li>
<li>사용자2 가 테이블 B에 대하여 쓰기 작업을 하면서 락을 걸었을때</li>
<li>사용자 1 이 테이블 B 에 대하여 쓰기 작업을 진행하려고 하면 락이 걸려서 대기 하게 된다. 아직 트랜잭션이 끝나지 않은 상태이기 때문에 테이블 A 에 걸려있는 락은 유지된다.</li>
<li>사용자 2가 이때 테이블 A 에 대해서 쓰기 작업을 하려고 하면 여전히 유지중인 테이블 A에 대한 락 때문에 대기하게 되고 무한대로 대기중인 상태에 빠지게 된다.</li>
</ol>
<h2 id="트랜잭션-처리-시-주의-사항"><a href="#트랜잭션-처리-시-주의-사항" class="headerlink" title="트랜잭션 처리 시 주의 사항"></a>트랜잭션 처리 시 주의 사항</h2><h3 id="데드락을-최소화-시키는-DBMS-전반적-대책"><a href="#데드락을-최소화-시키는-DBMS-전반적-대책" class="headerlink" title="데드락을 최소화 시키는 DBMS 전반적 대책"></a>데드락을 최소화 시키는 DBMS 전반적 대책</h3><ol>
<li>트랜잭션을 자주 커밋</li>
<li>정해진 순서로 테이블에 엑세스 하게 함.</li>
<li>필요 없는 경우에는 읽기 잠금 흭득 사용을 피함</li>
<li>쿼리에 의한 잠금 범위를 좁히거나 더 작은 것으로 하마</li>
<li>한 테이블 복수 행을 순서 없이 변경 없이 갱신하면 교착 상태 발생이 쉬움</li>
<li>테이블 단위 잠금 흭득해 갱신 직력화</li>
</ol>
<h3 id="자제해야-하는-트랜잭션-처리"><a href="#자제해야-하는-트랜잭션-처리" class="headerlink" title="자제해야 하는 트랜잭션 처리"></a>자제해야 하는 트랜잭션 처리</h3><ul>
<li>Auto Commit</li>
<li>긴 트랜잭션</li>
<li>트랜잭션 관련 설정 확인 : 트랜잭션 격리 수준 조정</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/DB/SQLD/211012-%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%84%A4%EA%B3%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/DB/SQLD/211012-%ED%85%8C%EC%9D%B4%EB%B8%94%20%EC%84%A4%EA%B3%84/" class="post-title-link" itemprop="url">테이블 설계</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:07:35 / Modified: 22:09:58" itemprop="dateCreated datePublished" datetime="2021-10-23T22:07:35+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="테이블-설계"><a href="#테이블-설계" class="headerlink" title="테이블 설계"></a>테이블 설계</h1><h2 id="테이블-설계의-기초"><a href="#테이블-설계의-기초" class="headerlink" title="테이블 설계의 기초"></a>테이블 설계의 기초</h2><p>테이블이란 ? 데이터를 관리 및 저장하는 장소, 효율적인 관리 및 적절한 조작이 매우 종요하고 실생활에서 광범위학게 사용되는 2차원 표와 유사하다.</p>
<h2 id="테이블-설계-규칙"><a href="#테이블-설계-규칙" class="headerlink" title="테이블 설계 규칙"></a>테이블 설계 규칙</h2><h3 id="집합을-나누는-방법"><a href="#집합을-나누는-방법" class="headerlink" title="집합을 나누는 방법"></a>집합을 나누는 방법</h3><p>집합을 나누는 방법에 따라 한개 혹은 여러개의 테이블이 될 수 있다.</p>
<p>예를 들어서 회원 테이블을 관리하고 있었는데, 새로운 기준이 적용 되어서 회원을 일반 회원과 프리미엄 회원 테이블로 나누는 경우가 이에 해당한다.</p>
<h3 id="데이터-베이스-vs-자바"><a href="#데이터-베이스-vs-자바" class="headerlink" title="데이터 베이스 vs 자바"></a>데이터 베이스 vs 자바</h3><p>데이터 베이스는 자바와 비교 될때가 많다.</p>
<p>데이터베이스에서 테이블은 자바에 클래스와 비교되고, 열은 클래스의 속성과 비교된다. 또한, 행은 자바에서 인스턴스와 비교되기도 한다.</p>
<h3 id="기본키"><a href="#기본키" class="headerlink" title="기본키"></a>기본키</h3><p>기본키는 특정 집합에서 특정 행을 유일하게 식별할 수 있는 속성의 집합이다. 예를 들면, 학번, 카드발급번호, 주민등록번호 등이 있다.</p>
<p>따라서 중복된 식별을 없에기 위해서 기본키는 중복 되면 안된다. 또한, 한번 정해지면 가급적 변경하지 않도록 한다.</p>
<p>기본키는 Null 값이 허용 되지 않는데, 업무 상의 이유로 기본키가 없는 테이블이 운영되는 곳이 간혹 있다.</p>
<h2 id="정규형"><a href="#정규형" class="headerlink" title="정규형"></a>정규형</h2><p>테이블을 제대로 된 형태로 만들자고 하는 것인데, 테이블을 쪼갤 수 있는 부분까지 쪼개는 것을 의미한다.</p>
<h3 id="제-1-정규형-1NF-위반"><a href="#제-1-정규형-1NF-위반" class="headerlink" title="제 1 정규형(1NF) 위반"></a>제 1 정규형(1NF) 위반</h3><p>테이블의 셀에 여러 개의 값을 포함하지 않는다.</p>
<p>예를 들어 회원 테이블에서 연락처를 컬럼을 전화번호, 이메일로 같이 관리하는 경우가 1 정규형 위반에 해당한다.</p>
<p>1 정규형 해소를 위해서는 기존에 회원 테이블에서 연락처를 분리해서 회원 연락처 테이블을 만들고 연락처 구분 컬럼을 만들어 핸드폰인지 이메일인지 구분해서 저장해야 한다.</p>
<h3 id="함수-종속성"><a href="#함수-종속성" class="headerlink" title="함수 종속성 ?"></a>함수 종속성 ?</h3><p>테이블은 함수오 같다. -&gt; 기본키의 값을 입력하면 특정 출력 값이 나오는 구조이기 때문이다.</p>
<p>예를 들어 환율 테이블에 경우 어떤 통화인지 기본키를 입력하면 환율이 나오는 방식으로 생각할 수 있는다. 어떤 값에 의해 값이 리턴되는 형식에 함수와 같다고 할 수 있다.</p>
<h3 id="제-2-정규형-2NF-위반"><a href="#제-2-정규형-2NF-위반" class="headerlink" title="제 2 정규형(2NF) 위반"></a>제 2 정규형(2NF) 위반</h3><p>부분 함수 종속성을 허용하지 않음..</p>
<p>부분 함수 종속이란 기본키를 구성하는 열의 일부에만 함수 종속이 존재 하는 것을 의미하는데, 예를들어서 주문 테이블은 고객 아이디와 주문번호를 복합키로 사용해서 주문을 구별한다. 주문 일자에 경우 고객 아이디와 주문번호를 통해서 주문 일자가 나오는게 맞는데 고객명과 고객등급은 복합키가 아닌 고객 아이디만 사용해도 알 수 있다. 이 경우 제 2 정규형 위반이라고 한다.</p>
<img src="/images/211012-테이블 설계/1.png" width="500">

<p>해소 하기 위해서는 고객 주문 테이블에서 고객명과 고객등급 컬럼을 삭제하고 고객 테이블을 따로 만들어서 부분 함수 종속을 제거해야 한다.</p>
<h3 id="제-3-정규형-3NF-위반"><a href="#제-3-정규형-3NF-위반" class="headerlink" title="제 3 정규형(3NF) 위반"></a>제 3 정규형(3NF) 위반</h3><p>기본 키를 제외한 일반 컬럼끼리 함수 종속이 발생한 경우에 위반했다고 한다.</p>
<p>예를 들어서 고객 테이블에 경우 고객 아이디를 통해서 고객 명과 나이가 판단되는 것은 맞지만 일반 컬럼인 직업코드와 직업명은 서로간에 함수 종속이 발생했다. 이경우 제 3 정규형 위반이라고 하고 해소 하기 위해서 고객 테이블에서 직업 명 컬럼을 삭제하고 직업테이블을 새로 만들어서 직업 코드 별 직업명을 확인하도록 한다.</p>
<img src="/images/211012-테이블 설계/2.png" width="500">

<h3 id="4-5-정규형"><a href="#4-5-정규형" class="headerlink" title="4, 5 정규형"></a>4, 5 정규형</h3><p>일반적으로 거의 쓰이지 않아서 따로 찾아볼것.. 3 정규형 까지는 확실히 알도록 하자.</p>
<h2 id="ER-다이어-그램"><a href="#ER-다이어-그램" class="headerlink" title="ER 다이어 그램"></a>ER 다이어 그램</h2><p>데이터 모델링 문야에서 개체-관계 모델이란 구조화된 데이터에 대한 일련이ㅡ 표현이다. 개체-관계 모델리을 하는 것을 ERM(Entity-Relationship Modelling)이라 하고 이에 대한 산출 물을 ERD(Entity-Relationship Diagram) 이라고 한다.</p>
<h3 id="Barker-표기법"><a href="#Barker-표기법" class="headerlink" title="Barker 표기법"></a>Barker 표기법</h3><p>ERD를 표시하는 기법 중 하나이고 요즘은 이걸 많이 사용한다.</p>
<img src="/images/211012-테이블 설계/3.png" width="900">

<h3 id="릴레이션십"><a href="#릴레이션십" class="headerlink" title="릴레이션십"></a>릴레이션십</h3><p>엔티티와 엔티티 간의 관계를 의미한다. 엔티티 간의 관계성을 표시한다.</p>
<img src="/images/211012-테이블 설계/4.png" width="900">

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/DB/SQLD/211014-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%20%EC%84%B1%EB%8A%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/DB/SQLD/211014-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%20%EC%84%B1%EB%8A%A5/" class="post-title-link" itemprop="url">데이터베이스 성능</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:07:35 / Modified: 22:09:58" itemprop="dateCreated datePublished" datetime="2021-10-23T22:07:35+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="데이터-베이스-성능"><a href="#데이터-베이스-성능" class="headerlink" title="데이터 베이스 성능"></a>데이터 베이스 성능</h1><h2 id="성능이란"><a href="#성능이란" class="headerlink" title="성능이란 ?"></a>성능이란 ?</h2><p>클라이언트 요청에 대한 응답시간(Response Time) 과 시간당 처리할 수 있는 처리량(Throughtput) 이다.</p>
<h3 id="용어-알아보기"><a href="#용어-알아보기" class="headerlink" title="용어 알아보기"></a>용어 알아보기</h3><p>Corrent User = Active User + Inactive User : 현제 사용자를 의미하는데 서버에 부하를 일으키는 Active User와 서버에 부하를 일으키지 않는 Inactive User로 나뉜다.</p>
<p>TPS : 서버가 일정 시간 내의 처리한 트랜잭션의 양</p>
<p>Response Time : 요청 후 응답을 받을 때 까지 소요된 시간</p>
<p>Resource : 한정된 값을 가진 시스템의 구성요소</p>
<h3 id="성능의-특성"><a href="#성능의-특성" class="headerlink" title="성능의 특성"></a>성능의 특성</h3><p>경합 부하 구간에서 Response Time이 급격하게 늘어나게 된다.</p>
<h2 id="데이터베이스-병목의-원인"><a href="#데이터베이스-병목의-원인" class="headerlink" title="데이터베이스 병목의 원인"></a>데이터베이스 병목의 원인</h2><p>여러 요인이 있지만 DBMS 내부 I/O 병목으로 인한 대기시간 증가가 가장 큰 이유이다. 대부분은 I/O(Sleep) 에서 발생힌다.</p>
<p>병목현상을 해결하기 위해서는</p>
<ul>
<li>절대적인 블록 I/O 를 줄여야 함.</li>
<li>블록 I/O를 줄이기 위한 모델 설계, DBMS 환경 구축, SQL 튜닝등의 기술이 필요함.</li>
</ul>
<h3 id="포로세스-생성-주기에-영향을-받는다"><a href="#포로세스-생성-주기에-영향을-받는다" class="headerlink" title="포로세스 생성 주기에 영향을 받는다."></a>포로세스 생성 주기에 영향을 받는다.</h3><p>여러 프로세스가 하나의 CPU를 공유 할 수 있지만, 특정 순간에는 하나의 프로세스만 CPU를 사용한다. 디스크에서 데이터를 읽어야할 땐 CPU를 OS에 반환하고 잠시 수면 상태에서 I/O 가 완료되기를 기다린다. 즉, SQL 문에서 발생하는 절대적인 I/O 횟루를 줄이는 것이 성냉 개선의 핵심이다.</p>
<h2 id="성능을-결정하는-요인"><a href="#성능을-결정하는-요인" class="headerlink" title="성능을 결정하는 요인"></a>성능을 결정하는 요인</h2><p>성능을 결정하는 가장 큰 요인에는 옵티마이저의 성능이 있다. 사용자가 SQL 문을 입력하면 옵티마이저는 파싱한 SQL를 최적화하여 프로시저로 변환시키는 작업을 한다.</p>
<p>옵티마이저는 통계정보를 이용해 각 실행 계획의 예상 비용을 산정한 후 최저 비용을 나나태는 실행 계획을 선택한다.</p>
<h3 id="옵티마이저가-참조하는-통계정보"><a href="#옵티마이저가-참조하는-통계정보" class="headerlink" title="옵티마이저가 참조하는 통계정보"></a>옵티마이저가 참조하는 통계정보</h3><p>SQL 파식 -&gt; 실행계획 작성 ( 통계 정보 활용) -&gt; 실행계획 선택 ( 옵티마이저의 역활) -&gt; SQL 실행</p>
<p>통계정보 :</p>
<ul>
<li>테이블의 행수</li>
<li>데이터형</li>
<li>크기</li>
<li>제약정보</li>
<li>인덱스에 대한 통계</li>
<li>열 값에 대한 통계 등등..</li>
</ul>
<h2 id="실행-계획은-어떻게-세워지는"><a href="#실행-계획은-어떻게-세워지는" class="headerlink" title="실행 계획은 어떻게 세워지는"></a>실행 계획은 어떻게 세워지는</h2><h3 id="인덱스"><a href="#인덱스" class="headerlink" title="인덱스"></a>인덱스</h3><p>지정한 컬럼을 기준으로 메모리 영역에 일종의 목차를 생성하는것, 조회 할때는 좋은 성능을 보이만, insert, update, delete 등의 작업을 해야 할때에는 인덱스 테이블까지 변경해하는 상황이 발생하면서 오히려 성능이 안좋을 수 있다.</p>
<p>``SQL<br>CREATE INDEX IDX_TB_EXECUTION_TEST_01 ON TB_EXECUTION_TEST(CUSTOMER_ID);</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">인덱스는 B-Tree를 사용하여 테이블을 조회한다. 반면에, 인데스가 없는 조회 조건은 모든 요소를 비교하면서 조회하게 된다. 이를 Table Full Scan 이라고 한다.</span><br><span class="line"></span><br><span class="line">반면에 인덱스를 사용하면 B-Tree를 이용하여 Range Scan 을 하게 된다.</span><br><span class="line"></span><br><span class="line">먼저 branch 노드에서 커르고 리픝 노드에서 수평적으로 검사하여 디스크에 접근 하는 것이다.</span><br><span class="line"></span><br><span class="line">인덱스를 사용할 컬럼은 카디너리티가 높은 컬럼을 사용해야 한다. 카디널리티는 Distint 명령을 수행했을때 숫자 라고 생각하면 쉽게 생각 할 수 있는데, 성별보다 주민등록 번호가 카디너리티가 높다는 것은 여기에 기인하여 생각할 수 있다.</span><br><span class="line">여러 컬럼으로 인덱스를 사용할때에는 카디너리티가 높은 순에서 낮은 순서로 사용해야 한다.</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/DB/SQLD/211014-%EB%B0%B1%EC%97%85%20%EB%B0%8F%20%EB%B3%B5%EA%B5%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/DB/SQLD/211014-%EB%B0%B1%EC%97%85%20%EB%B0%8F%20%EB%B3%B5%EA%B5%AC/" class="post-title-link" itemprop="url">백업 및 복구</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:07:35 / Modified: 22:09:58" itemprop="dateCreated datePublished" datetime="2021-10-23T22:07:35+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DB/" itemprop="url" rel="index"><span itemprop="name">DB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="백업-및-복구"><a href="#백업-및-복구" class="headerlink" title="백업 및 복구"></a>백업 및 복구</h1><h2 id="지속성과-성능이-양립하는-구조"><a href="#지속성과-성능이-양립하는-구조" class="headerlink" title="지속성과 성능이 양립하는 구조"></a>지속성과 성능이 양립하는 구조</h2><h3 id="로그-선행-기법"><a href="#로그-선행-기법" class="headerlink" title="로그 선행 기법"></a>로그 선행 기법</h3><p>WAL(Write-ahead logging)이라고 부르면, 시스템에서 모든 수정은 적용 이전에 로그에 기록된다. 예를 들어서 특정 프고그램이 진행되는 동안 정전이 일어났다고 가정해보자. 다시 시작할 때 프로그램은 어느 작업이 수행을 성공적으로 마쳤는지, 실패했는지 등의 정보를 알고 있어야 한다. 로그 선행 기법을 사용한다면 프로그램은 이러한 로그를 검사하여 예기치 않은 정전 시 해야 할 일과 실제 했던 일을 비교하게 된다.</p>
<h3 id="데이터베이스-버퍼"><a href="#데이터베이스-버퍼" class="headerlink" title="데이터베이스 버퍼"></a>데이터베이스 버퍼</h3><p>데이터 파일로의 입력을 데이터 베이스 버퍼를 경유해서 하도록 한다. (성능 양립을 위해서 )</p>
<p>순서 :</p>
<ol>
<li>갱신 대상의 데이터 포함한 블록이 버퍼풀에 있는지 확인</li>
<li>없을 경우 데이터 파일로부터 해당 블록을 읽어 들임.</li>
<li>버퍼 풀 내의 해당 블록을 갱신 수행</li>
<li>갱신 내용이 Commit 과 함께 로그에 기록</li>
<li>갱신 되었지만 데이터 파일에 쓰이지 않은 블록은 Dirty 블록이 됨.</li>
<li>갱신된 데이터 블록은 나중에 정리되어 데이터 파일에 적용됨(체크 포인트)</li>
<li>체크포인트 이전 로그 파일은 불필요 하게 됨</li>
<li>갱신과 더불어 위 순서 반복</li>
</ol>
<h3 id="Crash-복구-흐름"><a href="#Crash-복구-흐름" class="headerlink" title="Crash 복구 흐름"></a>Crash 복구 흐름</h3><p>Crash 가 발생하면</p>
<ul>
<li>WAL : 마지막으로 Commit 된 트랜잭션의 갱신 정보 가짐</li>
<li>데이터베이스 버퍼 : Crash 로 내용이 전부 소실</li>
<li>데이터베이스 파일 : 최후 체크포인트까지의 갱신 정보 가짐.</li>
</ul>
<p>-&gt; 데이터 베이스 파일을 Crash 전 최신 Commit 상태로 수정함.</p>
<h2 id="백업-및-복구-1"><a href="#백업-및-복구-1" class="headerlink" title="백업 및 복구"></a>백업 및 복구</h2><h3 id="백업의-3가지-관점"><a href="#백업의-3가지-관점" class="headerlink" title="백업의 3가지 관점"></a>백업의 3가지 관점</h3><ol>
<li>핫 백업과 콜드 백업</li>
<li>논리 백업과 물리 백업</li>
<li>풀 백업과 부분(증분/차등) 백업</li>
</ol>
<h3 id="핫백업과-콜드-백업"><a href="#핫백업과-콜드-백업" class="headerlink" title="핫백업과 콜드 백업"></a>핫백업과 콜드 백업</h3><p>핫 백엄 : 온라인 백엄/ 데이터 베이스 기능 이용, 데이터 베이스를 정지 하지 않고 백업 데이터를 얻음</p>
<p>콜드 백업 : 오프라인 백업 / OS 기능 이용, 서버를 내림고 데이터 베이스도 종료 시키고 OS 명령으로 복사</p>
<h3 id="논리-백업과-물리-백업"><a href="#논리-백업과-물리-백업" class="headerlink" title="논리 백업과 물리 백업"></a>논리 백업과 물리 백업</h3><p>논리 백업 : SQL 기반 텍스트 형식으로 백업 데이터 기록</p>
<ul>
<li>장점 : 이식성 우수, 편집가능, 이기종 간의 DB 이행 유리</li>
<li>단점 : 물리 백업보다 느림, 용량이 큼</li>
</ul>
<p>물리 백업 : 데이터 영역을 그대로 덤프 하는 이미지로 바이너리 형식 기록</p>
<ul>
<li>장점 : 최소 크기로 데이터 얻음, 백업 및 복원의 속도가 빠름</li>
<li>단점 : 일부 데이터의 내용 수정은 불가능, 호완성이 좋지 않음.</li>
</ul>
<h3 id="풀-백업꽈-부분-백업"><a href="#풀-백업꽈-부분-백업" class="headerlink" title="풀 백업꽈 부분 백업"></a>풀 백업꽈 부분 백업</h3><p>풀백업(전체 백업) : 데이터 베이스 전체 데이터를 매일 백업</p>
<p>부분 백업 : 풀 백업 이후 갱신된 데이터를 백업</p>
<ul>
<li>차등 백업</li>
<li>증분 백업</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/git/211009-basic%20branching%20and%20merging/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/git/211009-basic%20branching%20and%20merging/" class="post-title-link" itemprop="url">basic branching and merging</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:05:42 / Modified: 22:06:06" itemprop="dateCreated datePublished" datetime="2021-10-23T22:05:42+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Basic-Branching-and-Merging"><a href="#Basic-Branching-and-Merging" class="headerlink" title="Basic Branching and Merging"></a>Basic Branching and Merging</h1><p>실제 개발 과정에 flow는 다음과 같다.</p>
<ol>
<li>웹사이트가 있고 뭔가 작업을 진행중이다.</li>
<li>새로운 이슈를 처리할 branch를 하나를 생성한다.</li>
<li>새로 만든 branch에서 작업을 진행한다.</li>
</ol>
<p>이때 즁오한 문제가 생겨서 처리해야 할 일이 생긴다. 그러면 아래와 같이 진행한다.</p>
<ol>
<li>새로운 이슈를 처리하기 위해 운영 브랜치로 이동한다.</li>
<li>Hotfix 브랜치를 새로 하나 생성한다.</li>
<li>Hotfix 에서 문제를 수정하고 테스트를 마친 후 운영 브랜치로 머지한다.</li>
<li>다시 작업하던 brnahc로 이동하고 마찬가지로 작업 완료, 테스트 진행 후 운영 브랜치로 머지한다.</li>
</ol>
<h2 id="브랜치의-기초"><a href="#브랜치의-기초" class="headerlink" title="브랜치의 기초"></a>브랜치의 기초</h2><p>회사 내의 새로운 53번 이슈를 해결해야 한다면 다음과 같이 브랜치를 만들고 동시에 switch 할 수 도 있다. 옵션 플래그는 -b 이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b iss53</span><br><span class="line">Switched to a new branch &quot;iss53&quot;</span><br></pre></td></tr></table></figure>

<p>이제 iss53 브렌치에서 작업을 진행하고 커밋한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vim index.html</span><br><span class="line">$ git commit -a -m &#x27;added a new footer [issue 53]&#x27;</span><br></pre></td></tr></table></figure>

<p>그러면 main 브렌치보다 커밋을 하나 더한 상태가 된다. 이때 어떤 문제가 생겨서 빨리 해결해야 한다고 가정하자. 이를 해결 하기 위해서 우선은 main 브랜치로 이동하고 HotFix 브랜치를 만들어서 기존에 작업하던 iss53에 영향을 안주고 고칠 수 있다. 먼저 main 브렌치로 옮긴다. 아직 커밋하지 않은 checkout 브랜치와 충돌을 발생시킬수도 있는데 우선은 모두 커밋한 후에 main 브랜치로 이동하도록 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout master</span><br><span class="line">Switched to branch &#x27;master&#x27;</span><br></pre></td></tr></table></figure>

<p>(main 브랜치는 기본 브랜치라는 의미여서 이름은 master 여도 상관 없다. )</p>
<p>이제 hotfix 브랜치를 생성, 전환하고 작업한후 결과를 커밋한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b hotfix</span><br><span class="line">Switched to a new branch &#x27;hotfix&#x27;</span><br><span class="line">$ vim index.html</span><br><span class="line">$ git commit -a -m &#x27;fixed the broken email address&#x27;</span><br><span class="line">[hotfix 1fb7853] fixed the broken email address</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br></pre></td></tr></table></figure>

<p>작업이 완료 되었으면 다시 main 브랜치로 이동하고 hotfix 브랜치를 병합한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout master</span><br><span class="line">$ git merge hotfix</span><br><span class="line">Updating f42c576..3a0874c</span><br><span class="line">Fast-forward</span><br><span class="line"> index.html | 2 ++</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br></pre></td></tr></table></figure>

<p>hotfix 브랜치는 master 브랜치에서 단순히 이동만 시킨 상태가 되기 때문에 이를 fast=-foward라고 한다.</p>
<p>이제 hotfix 브랜치는 필요 없어졌기 때문에 삭제 하도록 한다. 플래그는 -d 이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d hotfix</span><br><span class="line">Deleted branch hotfix (3a0874c).</span><br></pre></td></tr></table></figure>

<p>그리고 다시 iss53 브랜치로 이동한 후 작업을 환료하도록 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout iss53</span><br><span class="line">Switched to branch &quot;iss53&quot;</span><br><span class="line">$ vim index.html</span><br><span class="line">$ git commit -a -m &#x27;finished the new footer [issue 53]&#x27;</span><br><span class="line">[iss53 ad82d7a] finished the new footer [issue 53]</span><br><span class="line">1 file changed, 1 insertion(+)</span><br></pre></td></tr></table></figure>

<p>작업을 완료하면 main 브랜치로 전환 한 후에 iss53번 브랜치와 병합한다. 그럼 hotfix 내용이 포함된 main 브랜치에 새로운 iss도 처리한 브랜치로 병합할 수 있다.</p>
<h2 id="Merge-의-기초"><a href="#Merge-의-기초" class="headerlink" title="Merge 의 기초"></a>Merge 의 기초</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout master</span><br><span class="line">Switched to branch &#x27;master&#x27;</span><br><span class="line">$ git merge iss53</span><br><span class="line">Merge made by the &#x27;recursive&#x27; strategy.</span><br><span class="line">index.html |    1 +</span><br><span class="line">1 file changed, 1 insertion(+)</span><br></pre></td></tr></table></figure>

<p>이번에 머지를 진행하면 hotfix 머지했때랑 다른 메세지를 보여준다. 이는 현제 브랜치가 가리키는 커밋이 머지할 브랜치의 조상이 아니므로 fast-foward로 병합하지 못하기 때문이다. 이 경우에 git은 이 둘의 공통 조상이 가리키는 스냅샷과 각각의 스냅샨을 사용한 3-way Merge 실행한다. 각각의 스냅샷을 비교한 후 새로운 커밋을 만들고 그 커밋의 조상이 각각의 브랜치를 바라보게 하는 것이다.</p>
<h2 id="충돌의-기초"><a href="#충돌의-기초" class="headerlink" title="충돌의 기초"></a>충돌의 기초</h2><p>3-way Merge를 진행할때 충돌이 발생하기도 한다. 충돌은 merge 하려는 브랜치에서 동일한 작업한 브랜치와 동일한 파일에 내용이 달라서 발생한다. 예를 들어 앞서서 hotfix에서 index.html에 대한 작업을 진행했고, iss53에서도 마찬가지로 index.html에 대한 작업을 진행했으면 아래와 같이 충돌이 발생한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git merge iss53</span><br><span class="line">Auto-merging index.html</span><br><span class="line">CONFLICT (content): Merge conflict in index.html</span><br><span class="line">Automatic merge failed; fix conflicts and then commit the result.</span><br></pre></td></tr></table></figure>

<p>git status 명령을 입력하여 어디가 충돌이 발생했는지 알 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">You have unmerged paths.</span><br><span class="line">  (fix conflicts and run &quot;git commit&quot;)</span><br><span class="line"></span><br><span class="line">Unmerged paths:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to mark resolution)</span><br><span class="line"></span><br><span class="line">    both modified:      index.html</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>

<p>Unmerged path: 에 있는 파일을 확인하면 된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:index.html</span><br><span class="line">&lt;div id=&quot;footer&quot;&gt;contact : email.support@github.com&lt;/div&gt;</span><br><span class="line">=======</span><br><span class="line">&lt;div id=&quot;footer&quot;&gt;</span><br><span class="line"> please contact us at support@github.com</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt; iss53:index.html</span><br></pre></td></tr></table></figure>

<p>해당 파일을 열어보면 다음과 같은 표시를 해준다. HEAD 브랜치는 main 브랜치이고 <code>=====</code> 다음에 내용은 iss53에 내요이다. 이럴때는 HEAD에 내용을 선택할지 iss53에 내용을 선택할지, 아니면 다 섞을지, 내용을 삭제할지 , 새로운 내용을 만들지 정한후 수정하면 된다.</p>
<p>밑에는 새로운 다 지우고 새로운 내용을 추가한 예제이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;footer&quot;&gt;</span><br><span class="line">please contact us at email.support@github.com</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>충돌을 해결하고 나서 해당 파일을 커밋하면 merge 에 대한 내용을 보여주고 merge된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Merge branch &#x27;iss53&#x27;</span><br><span class="line"></span><br><span class="line">Conflicts:</span><br><span class="line">    index.html</span><br><span class="line">#</span><br><span class="line"># It looks like you may be committing a merge.</span><br><span class="line"># If this is not correct, please remove the file</span><br><span class="line">#	.git/MERGE_HEAD</span><br><span class="line"># and try again.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Please enter the commit message for your changes. Lines starting</span><br><span class="line"># with &#x27;#&#x27; will be ignored, and an empty message aborts the commit.</span><br><span class="line"># On branch master</span><br><span class="line"># All conflicts fixed but you are still merging.</span><br><span class="line">#</span><br><span class="line"># Changes to be committed:</span><br><span class="line">#	modified:   index.html</span><br><span class="line">#</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jayoonkoo.github.io/2021/10/23/git/211010-git%20brnaching%20management/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JayoonKoo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="풍경보면서 일하고 싶다.">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/23/git/211010-git%20brnaching%20management/" class="post-title-link" itemprop="url">git brnaching management</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-23 22:05:42 / Modified: 22:06:07" itemprop="dateCreated datePublished" datetime="2021-10-23T22:05:42+09:00">2021-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Branching-management"><a href="#Branching-management" class="headerlink" title="Branching management"></a>Branching management</h1><h2 id="Branch-Management"><a href="#Branch-Management" class="headerlink" title="Branch Management"></a>Branch Management</h2><p><code>git branch</code> 를 인수 없이 실행하면 생성된 branch에 목록을 확인 할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git branch</span><br><span class="line">  iss53</span><br><span class="line">* master</span><br><span class="line">  testing</span><br></pre></td></tr></table></figure>

<p>prifix 인 * 는 현제 HEAD 가 가리키고 있는 브랜치를 뜻한다. 만약 지금 상태에서 작업을 진행하고 커밋하면 master 브랜치에 커밋 내역이 담기게 된다.</p>
<p><code>git branch -v</code> 를 입력하면 각 브랜치 마다 마지막 커밋을 볼 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -v</span><br><span class="line">  iss53   93b412c Fix javascript issue</span><br><span class="line">* master  7a98805 Merge branch &#x27;iss53&#x27;</span><br><span class="line">  testing 782fd34 Add scott to the author list in the readme</span><br></pre></td></tr></table></figure>

<p><code>--merged</code> 와 <code>--no-merged</code> 옵션을 사용하면 현제 브랜치에 병합된 브랜치나 병합되지 않은 브랜치를 확인할 수 있다. 현제 master 브랜치에서 병합된 브랜치에 목록을 보려면 다음과 같이 하면 된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git branch --merged</span><br><span class="line">  iss53</span><br><span class="line">* master</span><br></pre></td></tr></table></figure>

<p>일반적으로 이때 * 가 안붙은 브랜치는 삭제해도 무관한다. 이미 작업 내역에 통합했기 때문이다.</p>
<p><code>--no-merged</code> 옵션을 사용함녀 통합되지 않은 브랜치의 목록도 확인할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git branch --no-merged</span><br><span class="line">  testing</span><br></pre></td></tr></table></figure>

<p>이때 나오는 브랜치는 아직 통합하지 않았기 때문에 <code>-d</code> 옵션으로 삭제할 수 없다. 만약 강제로 삭제하고 싶다면 <code>-D</code> 옵션을 주어야 한다.</p>
<blockquote>
<p><code>--no-merged</code> 나 <code>-merged</code>에 옵션을 달았을때 아무런 인수를 주지 않으면 현제 브랜치에 대해서 조사합니다. 따라서 특정한 브랜치에 대해서 조사하고 싶다면 인수로 브랜치 이름을 주어야 합니다.</p>
</blockquote>
<h2 id="Changing-a-branch-name"><a href="#Changing-a-branch-name" class="headerlink" title="Changing a branch name"></a>Changing a branch name</h2><blockquote>
<p>주의 : 다른 사람이 작업중인 브랜치의 이름을 변경하지 마세요.</p>
</blockquote>
<p>브랜치 이름을 잘못 지어서 커밋 내역을 유지한 채로 좋은 이름으로 바꾸려면 어떻게 해야 할까? 또한, 리모트 저장소에도 바꾸려면 어떻게 해야 할까?</p>
<p>로컬에서는 다음과 같은 명령어로 할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch --move bad-branch-name correct-branch-name</span><br></pre></td></tr></table></figure>

<p>원격 저장소에도 변경 내용을 추가하고 싶다면 다음과 같이 입력한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push --set-stream origin correct-branch-name;</span><br></pre></td></tr></table></figure>

<p>다음으로 원격 저장소에 bad-branch-name 브랜치를 삭제해준다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin --delete bad-branch-name</span><br></pre></td></tr></table></figure>

<h2 id="Changing-the-master-branch-name"><a href="#Changing-the-master-branch-name" class="headerlink" title="Changing the master branch name"></a>Changing the master branch name</h2><blockquote>
<p>경고 : 메인 브랜치 이름을 변경하는 통합 서비스, 도우미 유틸리티, 빌드/릴리스 스크립트가 중단 될 수도 있다. 변경하기전에 반드시 공동작업자와 상의하길 바란다. 만약 변경했다면 철저히 분석해서 스크립트에서 이전 분기 이름에 대한 참조를 변경해야 한다.</p>
</blockquote>
<p>로컬에서 이름을 변경하려면 다음과 같이 해야 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch --move master main</span><br></pre></td></tr></table></figure>

<p>원격 저장소에도 적용하려면 다음과 같이 해야 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push --set-upstream origin main</span><br></pre></td></tr></table></figure>

<p>하지만 아직 원격 저장소에는 master 브랜치가 남아있고 다른 작업 자들은 기본 브랜치로 master 브랜치를 사용해서 작업 내용을 통합할 것이다. 그렇기 때문에 몇가지 추가 사항이 필요하다.</p>
<ul>
<li>이에 의존하는 모든 프로젝트는 코드 및/또는 구성을 업데이트해야 합니다.</li>
<li>테스트 실행기 구성 파일을 업데이트합니다.</li>
<li>빌드 및 릴리스 스크립트를 조정합니다.</li>
<li>리포지토리의 기본 분기, 병합 규칙 및 분기 이름과 일치하는 기타 항목에 대한 리포지토리 호스트의 설정을 리디렉션합니다.</li>
<li>문서에서 이전 분기에 대한 참조를 업데이트합니다.</li>
<li>이전 분기를 대상으로 하는 모든 pull 요청을 닫거나 병합합니다.</li>
</ul>
<p>모든 작업을 완료 한 후에 원격 저장소에 master 브랜치를 삭제하도록 한다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JayoonKoo</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
